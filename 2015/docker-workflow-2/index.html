<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/><title data-react-helmet="true">Docker workflow, part 2: jenkins | Blog</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75em Merriweather,Georgia,serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:Merriweather,Georgia,serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:3.5rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Merriweather,Georgia,serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:2.625rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Merriweather,Georgia,serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.75rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Merriweather,Georgia,serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.75rem;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Merriweather,Georgia,serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.75rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Merriweather,Georgia,serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.75rem;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:tnum;-moz-font-feature-settings:tnum;-ms-font-feature-settings:tnum;-webkit-font-feature-settings:tnum;padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}</style><link href="//fonts.googleapis.com/css?family=Montserrat:700|Merriweather:400,400i,700,700i,900,900i" rel="stylesheet" type="text/css"/><style>@font-face{font-family:octicons;src:url(/7b3fd4b10ef8298c7df5c5acad4b7e42.eot?#iefix) format("embedded-opentype"),url(/260ef443edb4dfd026d82e2b21a4c75c.woff) format("woff"),url(/ed294b221e32c83d9e79195d599313d3.ttf) format("truetype"),url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLz4=#octicons) format("svg");font-weight:400;font-style:normal}.mega-octicon,.octicon{font:normal normal normal 16px/1 octicons;display:inline-block;text-decoration:none;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mega-octicon{font-size:32px}.octicon-alert:before{content:"\F02D"}.octicon-arrow-down:before{content:"\F03F"}.octicon-arrow-left:before{content:"\F040"}.octicon-arrow-right:before{content:"\F03E"}.octicon-arrow-small-down:before{content:"\F0A0"}.octicon-arrow-small-left:before{content:"\F0A1"}.octicon-arrow-small-right:before{content:"\F071"}.octicon-arrow-small-up:before{content:"\F09F"}.octicon-arrow-up:before{content:"\F03D"}.octicon-beaker:before,.octicon-microscope:before{content:"\F0DD"}.octicon-bell:before{content:"\F0DE"}.octicon-bold:before{content:"\F0E2"}.octicon-book:before{content:"\F007"}.octicon-bookmark:before{content:"\F07B"}.octicon-briefcase:before{content:"\F0D3"}.octicon-broadcast:before{content:"\F048"}.octicon-browser:before{content:"\F0C5"}.octicon-bug:before{content:"\F091"}.octicon-calendar:before{content:"\F068"}.octicon-check:before{content:"\F03A"}.octicon-checklist:before{content:"\F076"}.octicon-chevron-down:before{content:"\F0A3"}.octicon-chevron-left:before{content:"\F0A4"}.octicon-chevron-right:before{content:"\F078"}.octicon-chevron-up:before{content:"\F0A2"}.octicon-circle-slash:before{content:"\F084"}.octicon-circuit-board:before{content:"\F0D6"}.octicon-clippy:before{content:"\F035"}.octicon-clock:before{content:"\F046"}.octicon-cloud-download:before{content:"\F00B"}.octicon-cloud-upload:before{content:"\F00C"}.octicon-code:before{content:"\F05F"}.octicon-comment-add:before,.octicon-comment:before{content:"\F02B"}.octicon-comment-discussion:before{content:"\F04F"}.octicon-credit-card:before{content:"\F045"}.octicon-dash:before{content:"\F0CA"}.octicon-dashboard:before{content:"\F07D"}.octicon-database:before{content:"\F096"}.octicon-clone:before,.octicon-desktop-download:before{content:"\F0DC"}.octicon-device-camera:before{content:"\F056"}.octicon-device-camera-video:before{content:"\F057"}.octicon-device-desktop:before{content:"\F27C"}.octicon-device-mobile:before{content:"\F038"}.octicon-diff:before{content:"\F04D"}.octicon-diff-added:before{content:"\F06B"}.octicon-diff-ignored:before{content:"\F099"}.octicon-diff-modified:before{content:"\F06D"}.octicon-diff-removed:before{content:"\F06C"}.octicon-diff-renamed:before{content:"\F06E"}.octicon-ellipsis:before{content:"\F09A"}.octicon-eye-unwatch:before,.octicon-eye-watch:before,.octicon-eye:before{content:"\F04E"}.octicon-file-binary:before{content:"\F094"}.octicon-file-code:before{content:"\F010"}.octicon-file-directory:before{content:"\F016"}.octicon-file-media:before{content:"\F012"}.octicon-file-pdf:before{content:"\F014"}.octicon-file-submodule:before{content:"\F017"}.octicon-file-symlink-directory:before{content:"\F0B1"}.octicon-file-symlink-file:before{content:"\F0B0"}.octicon-file-text:before{content:"\F011"}.octicon-file-zip:before{content:"\F013"}.octicon-flame:before{content:"\F0D2"}.octicon-fold:before{content:"\F0CC"}.octicon-gear:before{content:"\F02F"}.octicon-gift:before{content:"\F042"}.octicon-gist:before{content:"\F00E"}.octicon-gist-secret:before{content:"\F08C"}.octicon-git-branch-create:before,.octicon-git-branch-delete:before,.octicon-git-branch:before{content:"\F020"}.octicon-git-commit:before{content:"\F01F"}.octicon-git-compare:before{content:"\F0AC"}.octicon-git-merge:before{content:"\F023"}.octicon-git-pull-request-abandoned:before,.octicon-git-pull-request:before{content:"\F009"}.octicon-globe:before{content:"\F0B6"}.octicon-graph:before{content:"\F043"}.octicon-heart:before{content:"\2665"}.octicon-history:before{content:"\F07E"}.octicon-home:before{content:"\F08D"}.octicon-horizontal-rule:before{content:"\F070"}.octicon-hubot:before{content:"\F09D"}.octicon-inbox:before{content:"\F0CF"}.octicon-info:before{content:"\F059"}.octicon-issue-closed:before{content:"\F028"}.octicon-issue-opened:before{content:"\F026"}.octicon-issue-reopened:before{content:"\F027"}.octicon-italic:before{content:"\F0E4"}.octicon-jersey:before{content:"\F019"}.octicon-key:before{content:"\F049"}.octicon-keyboard:before{content:"\F00D"}.octicon-law:before{content:"\F0D8"}.octicon-light-bulb:before{content:"\F000"}.octicon-link:before{content:"\F05C"}.octicon-link-external:before{content:"\F07F"}.octicon-list-ordered:before{content:"\F062"}.octicon-list-unordered:before{content:"\F061"}.octicon-location:before{content:"\F060"}.octicon-gist-private:before,.octicon-git-fork-private:before,.octicon-lock:before,.octicon-mirror-private:before{content:"\F06A"}.octicon-logo-gist:before{content:"\F0AD"}.octicon-logo-github:before{content:"\F092"}.octicon-mail:before{content:"\F03B"}.octicon-mail-read:before{content:"\F03C"}.octicon-mail-reply:before{content:"\F051"}.octicon-mark-github:before{content:"\F00A"}.octicon-markdown:before{content:"\F0C9"}.octicon-megaphone:before{content:"\F077"}.octicon-mention:before{content:"\F0BE"}.octicon-milestone:before{content:"\F075"}.octicon-mirror-public:before,.octicon-mirror:before{content:"\F024"}.octicon-mortar-board:before{content:"\F0D7"}.octicon-mute:before{content:"\F080"}.octicon-no-newline:before{content:"\F09C"}.octicon-octoface:before{content:"\F008"}.octicon-organization:before{content:"\F037"}.octicon-package:before{content:"\F0C4"}.octicon-paintcan:before{content:"\F0D1"}.octicon-pencil:before{content:"\F058"}.octicon-person-add:before,.octicon-person-follow:before,.octicon-person:before{content:"\F018"}.octicon-pin:before{content:"\F041"}.octicon-plug:before{content:"\F0D4"}.octicon-file-add:before,.octicon-file-directory-create:before,.octicon-gist-new:before,.octicon-plus:before,.octicon-repo-create:before{content:"\F05D"}.octicon-primitive-dot:before{content:"\F052"}.octicon-primitive-square:before{content:"\F053"}.octicon-pulse:before{content:"\F085"}.octicon-question:before{content:"\F02C"}.octicon-quote:before{content:"\F063"}.octicon-radio-tower:before{content:"\F030"}.octicon-repo-delete:before,.octicon-repo:before{content:"\F001"}.octicon-repo-clone:before{content:"\F04C"}.octicon-repo-force-push:before{content:"\F04A"}.octicon-gist-fork:before,.octicon-repo-forked:before{content:"\F002"}.octicon-repo-pull:before{content:"\F006"}.octicon-repo-push:before{content:"\F005"}.octicon-rocket:before{content:"\F033"}.octicon-rss:before{content:"\F034"}.octicon-ruby:before{content:"\F047"}.octicon-search-save:before,.octicon-search:before{content:"\F02E"}.octicon-server:before{content:"\F097"}.octicon-settings:before{content:"\F07C"}.octicon-shield:before{content:"\F0E1"}.octicon-log-in:before,.octicon-sign-in:before{content:"\F036"}.octicon-log-out:before,.octicon-sign-out:before{content:"\F032"}.octicon-smiley:before{content:"\F0E7"}.octicon-squirrel:before{content:"\F0B2"}.octicon-star-add:before,.octicon-star-delete:before,.octicon-star:before{content:"\F02A"}.octicon-stop:before{content:"\F08F"}.octicon-repo-sync:before,.octicon-sync:before{content:"\F087"}.octicon-tag-add:before,.octicon-tag-remove:before,.octicon-tag:before{content:"\F015"}.octicon-tasklist:before{content:"\F0E5"}.octicon-telescope:before{content:"\F088"}.octicon-terminal:before{content:"\F0C8"}.octicon-text-size:before{content:"\F0E3"}.octicon-three-bars:before{content:"\F05E"}.octicon-thumbsdown:before{content:"\F0DB"}.octicon-thumbsup:before{content:"\F0DA"}.octicon-tools:before{content:"\F031"}.octicon-trashcan:before{content:"\F0D0"}.octicon-triangle-down:before{content:"\F05B"}.octicon-triangle-left:before{content:"\F044"}.octicon-triangle-right:before{content:"\F05A"}.octicon-triangle-up:before{content:"\F0AA"}.octicon-unfold:before{content:"\F039"}.octicon-unmute:before{content:"\F0BA"}.octicon-unverified:before{content:"\F0E8"}.octicon-verified:before{content:"\F0E6"}.octicon-versions:before{content:"\F064"}.octicon-watch:before{content:"\F0E0"}.octicon-remove-close:before,.octicon-x:before{content:"\F081"}.octicon-zap:before{content:"\26A1"}.spin-octicon{animation:spin-octicon 2s infinite linear}@keyframes spin-octicon{0%{transform:rotate(0deg)}to{transform:rotate(359deg)}}.href{text-decoration:none}.metadata{padding:5px;min-width:150px;display:inline-block;max-width:400px}.markdown pre{display:block;background:#3f3f3f;color:#dcdcdc;overflow-y:hidden}.markdown pre code{background:none;border:none;border-radius:3px;display:inline-block;overflow:inherit;padding:1.58333rem;white-space:inherit;word-wrap:normal}code{border-radius:3px;white-space:pre;white-space:pre-wrap;white-space:pre-line;white-space:-pre-wrap;white-space:-o-pre-wrap;white-space:-moz-pre-wrap;white-space:-hp-pre-wrap;word-wrap:break-word;background:#e5e5e5;border:1px solid #ccc;display:inline;font-family:Inconsolata,monospace,serif;max-width:100%;overflow:auto;padding:0 .1625rem}.clojure .hljs-attribute,.css .hljs-class,.css .hljs-id,.hljs-keyword,.hljs-request,.hljs-status,.hljs-tag,.lisp .hljs-title,.nginx .hljs-title{color:#e3ceab}.django .hljs-filter .hljs-argument,.django .hljs-template_tag,.django .hljs-variable{color:#dcdcdc}.hljs-date,.hljs-number{color:#8cd0d3}.apache .hljs-sqbracket,.dos .hljs-envvar,.dos .hljs-stream,.hljs-variable{color:#efdcbc}.diff .hljs-change,.dos .hljs-flow,.hljs-literal,.python .exception,.python .hljs-built_in,.tex .hljs-special{color:#efefaf}.diff .hljs-chunk,.hljs-subst{color:#8f8f8f}.apache .hljs-tag,.diff .hljs-header,.dos .hljs-keyword,.haskell .hljs-type,.hljs-prompt,.hljs-title,.nginx .hljs-built_in,.python .hljs-decorator,.ruby .hljs-class .hljs-parent,.tex .hljs-command{color:#efef8f}.dos .hljs-winutils,.ruby .hljs-string,.ruby .hljs-symbol,.ruby .hljs-symbol .hljs-string{color:#dca3a3}.apache .hljs-cbracket,.coffeescript .hljs-attribute,.css .hljs-rules .hljs-value,.diff .hljs-deletion,.hljs-attr_selector,.hljs-built_in,.hljs-javadoc,.hljs-pragma,.hljs-preprocessor,.hljs-pseudo,.hljs-string,.hljs-tag .hljs-value,.smalltalk .hljs-array,.smalltalk .hljs-class,.smalltalk .hljs-localvars,.sql .hljs-aggregate,.tex .hljs-formula{color:#cc9393}.diff .hljs-addition,.hljs-comment,.hljs-doctype,.hljs-pi,.hljs-shebang,.hljs-template_comment,.java .hljs-annotation{color:#7f9f7f}.coffeescript .javascript,.javascript .xml,.tex .hljs-formula,.xml .css,.xml .hljs-cdata,.xml .javascript,.xml .vbscript{opacity:.5}</style></head><body><div id="react-mount"><div style="max-width:63rem;margin-left:auto;margin-right:auto;padding:2.625rem 1.3125rem;" data-reactroot="" data-reactid="1" data-react-checksum="-1990421492"><h3 style="font-family:Montserrat, sans-serif;margin-top:0;" data-reactid="2"><a style="box-shadow:none;text-decoration:none;color:inherit;" href="/" data-reactid="3">Blog</a></h3><div class="markdown" data-reactid="4"><!-- react-empty: 5 --><h1 style="margin-top:0;" data-reactid="6">Docker workflow, part 2: jenkins</h1><div data-reactid="7"><p>We will discuss the technical details about implementing our workflow. This time, “Jenkins” comes first.</p>
<h2>Jenkins</h2>
<p>Jenkins provides us with an office docker image jenkins:latest at Docker hub. You can find its git repository jenkinsci/docker at Github.</p>
<p>My initial lifecycle events prepared for Jenkins will be:</p>
<pre><code>#Lifecycle Events
Start       : <span class="hljs-type">start</span> jenkins <span class="hljs-keyword">with</span> docker image <span class="hljs-keyword">with</span> essential settings
Deploy      : <span class="hljs-type">deploy</span> the latest/needed plugins <span class="hljs-keyword">or</span> configs I want
Maintenance : <span class="hljs-type">backup</span>/restore data
</code></pre>
<h2>Get It Run</h2>
<p>I choose to use its offical image to save my time. After it started, I sadly discoverd that I cloud only get jenkins user permission by running docker exec command. 11 #8798 will add functions to login to a specific user in docker exec I have to use the method provided in it’s github to install plugins (I use chef to help me previously), since I want to automate the “install plugins” process.</p>
<p>Its readme page suggests you to add a plugins.txt file and run its script to install them.</p>
<pre><code class="language-txt"><span class="hljs-selector-id">#Dockerfile</span>
FROM jenkins
COPY plugins<span class="hljs-selector-class">.txt</span> /usr/share/jenkins/plugins<span class="hljs-selector-class">.txt</span>
RUN /usr/local/bin/plugins<span class="hljs-selector-class">.sh</span> /usr/share/jenkins/plugins<span class="hljs-selector-class">.txt</span>
</code></pre>
<p>So I built my image and started it.</p>
<p><code>docker run -d -p 8080:8080 -v /opt/docker_volumes/jenkins:/var/jenkins_home --name jenkins1 -h jenkins1 gankkank/jenkins:1.596.2</code></p>
<p>However, it failed to install plugins.</p>
<p>After digging for a while with docker logs -f and docker exec, I found, somehow, it cloudn’t download the right files of plugins. 22 I will check this later since it’s not essential</p>
<pre><code>jenkins@jenkins2:/$ cat /var/jenkins_home/plugins/embeddable-build-status.hpi
<span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>404 Not Found<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Not Found<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>The requested URL /plugins/embeddable-build-status//embeddable-build-status.hpi was not found on this server.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">address</span>&gt;</span>Apache/2.2.14 (Ubuntu) Server at mirrors.jenkins-ci.org Port 80<span class="hljs-tag">&lt;/<span class="hljs-name">address</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2>Deploy</h2>
<p>Since it’s not essential for me to prepare all plugins during the “Start” lifecycle, I will go with my approach.</p>
<p>Add Script to install plugins <a href="http://install-plugins.sh">install-plugins.sh</a> 33 Need second thought on this, using bash script is not quite a good idea</p>
<pre><code class="language-sh"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># Install plugins</span>
<span class="hljs-keyword">for</span> plugin <span class="hljs-keyword">in</span> <span class="hljs-variable">$@</span>; <span class="hljs-keyword">do</span>
  java -jar /var/jenkins_home/war/WEB-INF/jenkins-cli.jar <span class="hljs-_">-s</span> http://localhost:8080/  install-plugin <span class="hljs-variable">$plugin</span>
<span class="hljs-keyword">done</span>
</code></pre>
<p>Add Script to update index. <a href="http://update-index.sh">update-index.sh</a></p>
<pre><code class="language-sh"><span class="hljs-meta">#!/bin/bash</span>
wget http://updates.jenkins-ci.org/update-center.json -qO- | sed <span class="hljs-string">'1d;$d'</span>  &gt; /var/jenkins_home/updates/default.json
</code></pre>
<p>Then add in dockerfile:</p>
<pre><code class="language-txt">#Dockerfile
FROM jenkins

# <span class="hljs-keyword">Copy</span> Scripts
<span class="hljs-keyword">COPY</span> install-plugins.<span class="hljs-keyword">sh</span> /<span class="hljs-keyword">var</span>/jenkins_home/install-plugins.<span class="hljs-keyword">sh</span>
<span class="hljs-keyword">COPY</span> <span class="hljs-keyword">update</span>-index.<span class="hljs-keyword">sh</span> /<span class="hljs-keyword">var</span>/jenkins_home/<span class="hljs-keyword">update</span>-index.<span class="hljs-keyword">sh</span>
</code></pre>
<p>Build, tag and run my image again:</p>
<pre><code class="language-sh"><span class="hljs-comment"># Run</span>
docker run <span class="hljs-_">-d</span> -p 8081:8080 -v /opt/docker_volumes/jenkins:/var/jenkins_home \
  --name jenkins2 -h jenkins2 -t gankkank/jenkins:1.596.2

<span class="hljs-comment"># Update Index</span>
docker <span class="hljs-built_in">exec</span> -t jenkins2 bash /var/jenkins_home/update-index.sh

<span class="hljs-comment"># Install Plugin</span>
docker <span class="hljs-built_in">exec</span> -t jenkins2 bash /var/jenkins_home/install-plugins.sh \
  git git-client ansicolor view-job-filters build-pipeline-plugin simple-theme-plugin \
  jquery dashboard-view jenkins-multijob-plugin warnings github rubyMetrics \
  AdaptivePlugin embeddable-build-status

<span class="hljs-comment"># Restart</span>
docker <span class="hljs-built_in">exec</span> -t jenkins2 \
    java -jar /var/jenkins_home/war/WEB-INF/jenkins-cli.jar <span class="hljs-_">-s</span> http://localhost:8080/ restart
</code></pre>
<p>Ok, That’s done and it seems no problem occured.</p>
<h2>Backup and Restore</h2>
<p>According to Docker volumns page, Docker suggests us to create a volumn instance and then launch another instance to use volumn from the previous one. This helps us to backup and restore data without getting our hands dirty with Docker host (avoid matching the host uid/gid to a container uid/gid, etc). 44 Blogs 1, 2</p>
<p>In generally, we will start two instances:</p>
<pre><code><span class="hljs-comment"># Create data volumn container (without -d)</span>
docker create -v /opt/docker_volumes/jenkins:/<span class="hljs-keyword">var</span>/jenkins_home --name jenkins_home ubuntu /bin/<span class="hljs-literal">true</span>

<span class="hljs-comment"># Launch docker instance</span>
docker run -d -p <span class="hljs-number">8083</span>:<span class="hljs-number">8080</span> --volumes-<span class="hljs-keyword">from</span> jenkins_home --name jenkins3 gankkank/jenkins:<span class="hljs-number">1.596</span>.<span class="hljs-number">2</span>
When we want <span class="hljs-keyword">to</span> backup/restore the data, we will launch docker instances <span class="hljs-keyword">to</span> <span class="hljs-keyword">do</span> the tasks <span class="hljs-keyword">for</span> us.

<span class="hljs-comment"># Backup</span>
docker run --volumes-<span class="hljs-keyword">from</span> jenkins_home -v $(pwd):/backup ubuntu:<span class="hljs-number">14.04</span> tar <span class="hljs-string">\</span>
    cvf /backup/jenkins-<span class="hljs-number">2015</span>-<span class="hljs-number">05</span>-<span class="hljs-number">06.tar</span> /<span class="hljs-keyword">var</span>/jenkins_home

<span class="hljs-comment"># Restore. (After launch a new data container)</span>
docker create -v /opt/docker_volumes/jenkins_b:/<span class="hljs-keyword">var</span>/jenkins_home <span class="hljs-string">\</span>
    --name jenkins_home_b ubuntu:<span class="hljs-number">14.04</span> /bin/<span class="hljs-literal">true</span>

docker run --volumes-<span class="hljs-keyword">from</span> jenkins_home_b -v $(pwd):/backup ubuntu:<span class="hljs-number">14.04</span> <span class="hljs-string">\</span>
    tar xvf /backup/jenkins-<span class="hljs-number">2015</span>-<span class="hljs-number">05</span>-<span class="hljs-number">06.tar</span>
</code></pre>
<p>By default, the container’s file system persists after the container exits. So, you’d better run backup/restore with --rm option.</p>
<h2>Last</h2>
<p>Finally, Docker’s way seems a quite different way from the traditional one. Hopefully it will help us get things done easier.</p>
</div><em style="display:block;margin-bottom:3.5rem;" data-reactid="8"><!-- react-text: 9 -->Posted <!-- /react-text --><!-- react-text: 10 -->March 7, 2015<!-- /react-text --></em><hr style="margin-bottom:3.5rem;" data-reactid="11"/><noscript data-reactid="12"></noscript><div data-reactid="13"><p style="margin-bottom:4.375rem;" data-reactid="14"><img style="-webkit-box-pack:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-align-items:center;-webkit-justify-content:center;-ms-flex-align:center;-webkit-box-align:center;-ms-flex-pack:center;width:60px;background-color:rgb(188, 188, 188);color:#ffffff;user-select:none;display:-webkit-box; display: -moz-box; display: -ms-inline-flexbox; display: -webkit-inline-flex; display: inline-flex;align-items:center;justify-content:center;font-size:30px;border-radius:50%;height:60px;float:left;" size="60" alt="author Jimmy Yang" src="/5740e643fc66e63bf2910d81f78ea8ce.jpeg" data-reactid="15"/><!-- react-text: 16 -->Written by <!-- /react-text --><strong data-reactid="17">Jimmy Yang</strong><!-- react-text: 18 --> who lives and works in Hong Kong.<!-- /react-text --><br data-reactid="19"/><!-- react-text: 20 -->Focusing on DevOps, Cloud Services, Microservices etc. Find me at <!-- /react-text --><a class="href" href="https://github.com/gankkank" data-reactid="21"><span class="mega-octicon octicon-octoface href" data-reactid="22"></span></a></p></div></div><span style="display:block;clear:both;" data-reactid="23"> </span></div></div><script src="/bundle.js?t=1496135026757"></script></body></html>